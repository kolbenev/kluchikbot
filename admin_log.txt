file must be non-empty
